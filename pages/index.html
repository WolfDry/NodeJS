<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Chat app</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <nav>
    <a href="/chat">Chat</a>
    <a href="/profile">Profile</a>
  </nav>
  <section>
    <h1>Accueil</h1>
    <form action="" method="post">
      <h3>Create a post</h3>
      <textarea name="content" cols="30" rows="10"></textarea>
      <button type="submit">Post</button>
    </form>
  </section>
  <section>
    <div id="posts"></div>
  </section>

  <script>
    const xhttp = new XMLHttpRequest();
      xhttp.onload = function() {
          var result = this.responseText;
          data = JSON.parse(result)
          
          divPost = document.getElementById('posts')
          for (let index = 0; index < data.length; index++) {
            const element = data[index];
            let div = document.createElement('div')
            div.id = "post"
            let content = document.createElement('p')
            content.innerHTML = element.content
            let date = document.createElement('span')
            const elementDate = new Date(element.createdAt)
            date.innerHTML = elementDate.toLocaleString()
            div.appendChild(content)
            div.appendChild(date)
            divPost.appendChild(div)
          }
      }
      xhttp.open("GET", "/getposts");
      xhttp.send();
  </script>
</body>
</html>
